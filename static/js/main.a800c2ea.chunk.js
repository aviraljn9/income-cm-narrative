(this["webpackJsonpincome-cm-narrative"]=this["webpackJsonpincome-cm-narrative"]||[]).push([[0],{66:function(t,e,n){},67:function(t,e,n){},70:function(t,e,n){"use strict";n.r(e);var r=n(2),a=n.n(r),i=n(28),c=n.n(i),s=(n(66),n.p,n(67),n(6)),o=n(7),l=n(3),u=n(8),h=n(9),d=n(4),m=n.n(d),f=n(13),y=n(0),v=n(1),p=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this,t)).svgRef=a.a.createRef(),r.state={year:1800},r.setyear=r.setyear.bind(Object(l.a)(r)),r.tick=r.tick.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"updatechart",value:function(){var t=this,e=this.median_childmortality.filter((function(e){return e.year<=t.state.year})),n=this.median_income.filter((function(e){return e.year<=t.state.year})),r=y.f().domain([1800,2040]).range([0,700]),a=y.f().domain([0,500]).range([300,0]),i=y.g().domain([200,179e3]).range([300,0]);y.h("#scatter").html(""),y.h("#scatter").append("g").attr("transform","translate(50,50)").selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t,e){return r(t.year)})).attr("cy",(function(t,e){return a(t.median_val)})).attr("r",(function(t,e){return 1.5})).attr("fill",(function(t,e){return t.year>2021?"red":"lightblue"})),y.h("#scatter").append("g").attr("transform","translate(50,50)").call(y.b(a).tickFormat(y.d("~s"))),y.h("svg").append("g").attr("transform","translate(50,350)").call(y.a(r)),y.h("#scatter").append("g").attr("transform","translate(50,450)").selectAll("circle").data(n).enter().append("circle").attr("cx",(function(t,e){return r(t.year)})).attr("cy",(function(t,e){return i(t.median_val)})).attr("r",(function(t,e){return 1.5})).attr("fill",(function(t,e){return t.year>2021?"red":"lightblue"})),y.h("#scatter").append("g").attr("transform","translate(50,450)").call(y.b(i).tickValues([300,1e3,3e3,1e4,3e4,1e5]).tickFormat(y.d("~s"))),y.h("svg").append("g").attr("transform","translate(50,750)").call(y.a(r))}},{key:"componentDidMount",value:function(){var t=Object(f.a)(m.a.mark((function t(){var e,n,r=this;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("chart mounted"),t.next=3,y.c("/income-cm-narrative/income_processed.csv");case 3:return this.incomedata=t.sent,t.next=6,y.c("/income-cm-narrative/child_mortality_0_5_year_olds_dying_per_1000_born.csv");case 6:for(this.cm_data=t.sent,this.median_childmortality=[],this.median_income=[],e=function(t){var e=r.incomedata.map((function(e){var n=r.cm_data.find((function(t){return t.country===e.country}));return void 0===n||isNaN(e[t])||isNaN(n[t])?null:{country:e.country,income:e[t],child_mortality:n[[t]]}})).filter((function(t){return t.child_mortality>0})),n=function(t,e){return t+parseFloat(e)},a=e.map((function(t){return t.child_mortality})).reduce(n,0);r.median_childmortality.push({year:t,median_val:a/e.length});var i=e.map((function(t){return t.income})).reduce(n,0);r.median_income.push({year:t,median_val:i/e.length})},n=1800;n<2041;n++)e(n);console.log(this.median_childmortality),console.log(this.median_income),this.updatechart(),this.timerID=setInterval((function(){return r.tick()}),25);case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("Unmounting"),clearInterval(this.timerID),this.timerID=null,y.h("#scatter").html("")}},{key:"componentDidUpdate",value:function(){this.updatechart()}},{key:"tick",value:function(){if(this.state.year>=2040)return clearInterval(this.timerID),void(this.timerID=null);this.setState((function(t,e){return{year:t.year+1}}))}},{key:"setyear",value:function(t){clearInterval(this.timerID),this.timerID=null,this.setState({year:t.target.value})}},{key:"render",value:function(){return Object(v.jsxs)("div",{children:[Object(v.jsxs)("form",{children:[Object(v.jsx)("label",{for:"year",children:"Please select a year: "}),Object(v.jsx)("input",{type:"range",min:1800,max:2040,step:1,id:"year",value:this.state.year,onInput:this.setyear}),Object(v.jsx)("output",{name:"selected_year",id:"selected_year",children:this.state.year})]}),Object(v.jsx)("svg",{id:"scatter",width:800,height:800,ref:this.svgRef})]})}}]),n}(r.Component),j=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this,t)).svgRef=a.a.createRef(),r.state={year:1800},r.setyear=r.setyear.bind(Object(l.a)(r)),r.tick=r.tick.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"updatechart",value:function(){var t=this,e=this.incomedata.map((function(e){var n=t.cm_data.find((function(t){return t.country===e.country}));return void 0===n||isNaN(e[t.state.year])||isNaN(n[t.state.year])?null:{country:e.country,income:e[t.state.year],child_mortality:n[[t.state.year]]}})).filter((function(t){return t.child_mortality>0})),n=1e3,r=1.5;null===this.timerID&&(2021==this.state.year&&(n=150),r=3);var a=y.g().domain([200,179e3]).range([0,700]),i=y.f().domain([0,n]).range([700,0]);y.h("#scatter").html(""),y.h("#scatter").append("g").attr("transform","translate(50,50)").selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t,e){return a(t.income)})).attr("cy",(function(t,e){return i(t.child_mortality)})).attr("r",(function(t,e){return r})).attr("fill","lightblue"),y.h("#scatter").append("g").attr("transform","translate(50,50)").call(y.b(i).tickFormat(y.d("~s"))),y.h("svg").append("g").attr("transform","translate(50,750)").call(y.a(a).tickValues([300,1e3,3e3,1e4,3e4,1e5]).tickFormat(y.d("~s")))}},{key:"componentDidMount",value:function(){var t=Object(f.a)(m.a.mark((function t(){var e=this;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("/income-cm-narrative"),t.next=3,y.c("/income-cm-narrative/income_processed.csv");case 3:return this.incomedata=t.sent,t.next=6,y.c("/income-cm-narrative/child_mortality_0_5_year_olds_dying_per_1000_born.csv");case 6:this.cm_data=t.sent,this.updatechart(),this.timerID=setInterval((function(){return e.tick()}),25);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("Unmounting"),clearInterval(this.timerID),this.timerID=null,y.h("#scatter").html("")}},{key:"componentDidUpdate",value:function(){this.updatechart()}},{key:"tick",value:function(){if(this.state.year>=2040)return clearInterval(this.timerID),this.timerID=null,void this.setState((function(t,e){return{year:2021}}));this.setState((function(t,e){return{year:t.year+1}}))}},{key:"setyear",value:function(t){clearInterval(this.timerID),this.timerID=null,this.setState({year:t.target.value})}},{key:"render",value:function(){return Object(v.jsxs)("div",{children:[Object(v.jsxs)("form",{children:[Object(v.jsx)("label",{for:"year",children:"Please select a year: "}),Object(v.jsx)("input",{type:"range",min:1800,max:2040,step:1,id:"year",value:this.state.year,onInput:this.setyear}),Object(v.jsx)("output",{name:"selected_year",id:"selected_year",children:this.state.year})]}),Object(v.jsx)("svg",{id:"scatter",width:800,height:800,ref:this.svgRef})]})}}]),n}(r.Component),b=n(29),g=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this,t)).svgRef=a.a.createRef(),r.state={year:1800},r.setyear=r.setyear.bind(Object(l.a)(r)),r.tick=r.tick.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"updatechart",value:function(){var t=this,e=500;2021==this.state.year&&null===this.timerID&&(e=100);for(var n=this.incomedata.map((function(e){var n=t.cm_data.find((function(t){return t.country===e.country}));return void 0===n||isNaN(e[t.state.year])||isNaN(n[t.state.year])?null:{country:e.country,income:e[t.state.year],child_mortality:n[[t.state.year]]}})).filter((function(t){return t.child_mortality>0})),r=n.sort((function(t,e){return parseFloat(t.income)-parseFloat(e.income)})).length,a=Math.floor(r/10),i={},c=0;c<10;c++)i[c]=[];for(var s=0;s<r;s++){var o=Math.floor(s/a);i[o=Math.min(o,9)].push(n[s])}for(var l=[],u=function(t,e){return t+parseFloat(e)},h=0;h<10;h++){var d=i[h],m=d.length,f=d.map((function(t){return t.child_mortality})).reduce(u,0),v=d.map((function(t){return t.income})).reduce(u,0);l.push({cm_avg:f/m,income_avg:v/m})}var p=y.e().domain(Object(b.a)(Array(10).keys())).range([0,700]).paddingInner(.2).paddingOuter(.2),j=y.f().domain([0,e]).range([700,0]);y.g().domain([200,179e3]).range([300,0]);y.h("#scatter").html(""),y.h("#scatter").append("g").attr("transform","translate(50,50)").selectAll("rect").data(l).enter().append("rect").attr("x",(function(t,e){return p(e)})).attr("y",(function(t,e){return j(t.cm_avg)})).attr("width",(function(t,e){return p.bandwidth()})).attr("height",(function(t,e){return 700-j(t.cm_avg)})).attr("fill",(function(t,e){return t.year>2021?"red":"lightblue"})),y.h("#scatter").append("g").attr("transform","translate(50,50)").call(y.b(j).tickFormat(y.d("~s"))),y.h("svg").append("g").attr("transform","translate(50,750)").call(y.a(p))}},{key:"componentDidMount",value:function(){var t=Object(f.a)(m.a.mark((function t(){var e=this;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("chart mounted"),t.next=3,y.c("/income-cm-narrative/income_processed.csv");case 3:return this.incomedata=t.sent,t.next=6,y.c("/income-cm-narrative/child_mortality_0_5_year_olds_dying_per_1000_born.csv");case 6:this.cm_data=t.sent,this.updatechart(),this.timerID=setInterval((function(){return e.tick()}),25);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("Unmounting"),clearInterval(this.timerID),this.timerID=null,y.h("#scatter").html("")}},{key:"componentDidUpdate",value:function(){this.updatechart()}},{key:"tick",value:function(){if(this.state.year>=2040)return clearInterval(this.timerID),this.timerID=null,void this.setState((function(t,e){return{year:2021}}));this.setState((function(t,e){return{year:t.year+1}}))}},{key:"setyear",value:function(t){clearInterval(this.timerID),this.timerID=null,this.setState({year:t.target.value})}},{key:"render",value:function(){return Object(v.jsxs)("div",{children:[Object(v.jsxs)("form",{children:[Object(v.jsx)("label",{for:"year",children:"Please select a year: "}),Object(v.jsx)("input",{type:"range",min:1800,max:2040,step:1,id:"year",value:this.state.year,onInput:this.setyear}),Object(v.jsx)("output",{name:"selected_year",id:"selected_year",children:this.state.year})]}),Object(v.jsx)("svg",{id:"scatter",width:800,height:800,ref:this.svgRef})]})}}]),n}(r.Component),_=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this,t)).svgRef=a.a.createRef(),r.state={scene:0},r.setscene=r.setscene.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"setscene",value:function(){this.setState({scene:(this.state.scene+1)%3})}},{key:"render",value:function(){return 0==this.state.scene?Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{onClick:this.setscene,children:"Change"}),Object(v.jsx)(j,{})]}):1==this.state.scene?Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{onClick:this.setscene,children:"Change"}),Object(v.jsx)(p,{})]}):Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{onClick:this.setscene,children:"Change"}),Object(v.jsx)(g,{})]})}}]),n}(r.Component);var O=function(){return Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(_,{})})},k=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,71)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),r(t),a(t),i(t),c(t)}))};c.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(O,{})}),document.getElementById("root")),k()}},[[70,1,2]]]);
//# sourceMappingURL=main.a800c2ea.chunk.js.map