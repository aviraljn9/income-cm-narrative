(this["webpackJsonpincome-cm-narrative"]=this["webpackJsonpincome-cm-narrative"]||[]).push([[0],{107:function(t,e,a){},108:function(t,e,a){},111:function(t,e,a){"use strict";a.r(e);var n=a(2),r=a.n(n),i=a(36),c=a.n(i),s=(a(107),a.p,a(108),a(6)),o=a(7),l=a(3),u=a(8),d=a(9),h=a(4),m=a.n(h),y=a(13),p=a(0),f=a(1),v=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(s.a)(this,a),(n=e.call(this,t)).svgRef=r.a.createRef(),n.state={year:1800},n.setyear=n.setyear.bind(Object(l.a)(n)),n.tick=n.tick.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"updatechart",value:function(){var t=this,e=this.median_childmortality.filter((function(e){return e.year<=t.state.year})).sort((function(t,e){return parseFloat(t.year)-parseFloat(e.year)})),a=this.median_income.filter((function(e){return e.year<=t.state.year})).sort((function(t,e){return parseFloat(t.year)-parseFloat(e.year)})),n=p.g().domain([1800,2040]).range([0,700]),r=p.g().domain([0,500]).range([300,0]),i=p.h().domain([200,179e3]).range([300,0]);p.e().x((function(t){return n(t.year)})).y((function(t){return r(t.median_val)}));p.i("#scatter").html(""),p.i("#ttip").html("");var c=p.i("#ttip").append("div").attr("class","tooltip").style("opacity",0);this.addpath(e.filter((function(t){return t.year<=2021})),"steelblue",n,r,"translate(50,50)"),this.addpath(e.filter((function(t){return t.year>=2021})),"red",n,r,"translate(50,50)"),this.addtooltips(e,n,r,c,"translate(50,50)"),p.i("#scatter").append("g").attr("transform","translate(50,50)").call(p.b(r).tickFormat(p.d("~s"))),p.i("svg").append("g").attr("transform","translate(50,350)").call(p.a(n)),this.addpath(a.filter((function(t){return t.year<=2021})),"steelblue",n,i,"translate(50,450)"),this.addpath(a.filter((function(t){return t.year>=2021})),"red",n,i,"translate(50,450)"),this.addtooltips(a,n,i,c,"translate(50,450)"),p.i("#scatter").append("g").attr("transform","translate(50,450)").call(p.b(i).tickValues([300,1e3,3e3,1e4,3e4,1e5]).tickFormat(p.d("~s"))),p.i("svg").append("g").attr("transform","translate(50,750)").call(p.a(n))}},{key:"addpath",value:function(t,e,a,n,r){p.i("#scatter").append("g").attr("transform",r).append("path").datum(t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("d",p.e().x((function(t){return a(t.year)})).y((function(t){return n(t.median_val)})))}},{key:"addtooltips",value:function(t,e,a,n,r){p.i("#scatter").append("g").attr("transform",r).selectAll("rect").data(t).enter().append("rect").attr("x",(function(t,a){return e(t.year)})).attr("y",(function(t,e){return 0})).attr("width",(function(t,e){return 1})).attr("height",(function(t,e){return 300})).attr("fill","black").attr("opacity",0).on("mouseover",(function(t,e){p.i(this).attr("opacity",1),n.transition().duration(200).style("opacity",1),n.html(e.year+"<br/>"+e.median_val).style("left",t.pageX+"px").style("top",t.pageY-28+"px")})).on("mouseout",(function(t,e){p.i(this).attr("opacity",0),n.transition().duration(500).style("opacity",0)}))}},{key:"componentDidMount",value:function(){var t=Object(y.a)(m.a.mark((function t(){var e,a,n=this;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("chart mounted"),t.next=3,p.c("/income-cm-narrative/income_processed.csv");case 3:return this.incomedata=t.sent,t.next=6,p.c("/income-cm-narrative/child_mortality_0_5_year_olds_dying_per_1000_born.csv");case 6:for(this.cm_data=t.sent,this.median_childmortality=[],this.median_income=[],e=function(t){var e=n.incomedata.map((function(e){var a=n.cm_data.find((function(t){return t.country===e.country}));return void 0===a||isNaN(e[t])||isNaN(a[t])?null:{country:e.country,income:e[t],child_mortality:a[[t]]}})).filter((function(t){return t.child_mortality>0})),a=function(t,e){return t+parseFloat(e)},r=e.map((function(t){return t.child_mortality})).reduce(a,0);n.median_childmortality.push({year:t,median_val:r/e.length});var i=e.map((function(t){return t.income})).reduce(a,0);n.median_income.push({year:t,median_val:i/e.length})},a=1800;a<2041;a++)e(a);console.log(this.median_childmortality),console.log(this.median_income),this.updatechart(),this.timerID=setInterval((function(){return n.tick()}),25);case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("Unmounting"),clearInterval(this.timerID),this.timerID=null,p.i("#scatter").html(""),p.i("#ttip").html("")}},{key:"componentDidUpdate",value:function(){this.updatechart()}},{key:"tick",value:function(){if(this.state.year>=2040)return clearInterval(this.timerID),void(this.timerID=null);this.setState((function(t,e){return{year:t.year+1}}))}},{key:"setyear",value:function(t){clearInterval(this.timerID),this.timerID=null,this.setState({year:t.target.value})}},{key:"render",value:function(){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("form",{children:[Object(f.jsx)("label",{for:"year",children:"Please select a year: "}),Object(f.jsx)("input",{type:"range",min:1800,max:2040,step:1,id:"year",value:this.state.year,onInput:this.setyear}),Object(f.jsx)("output",{name:"selected_year",id:"selected_year",children:this.state.year})]}),Object(f.jsx)("div",{id:"ttip"}),Object(f.jsx)("svg",{id:"scatter",width:800,height:800,ref:this.svgRef})]})}}]),a}(n.Component),j=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(s.a)(this,a),(n=e.call(this,t)).svgRef=r.a.createRef(),n.state={year:1800},n.setyear=n.setyear.bind(Object(l.a)(n)),n.tick=n.tick.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"updatechart",value:function(){var t=this,e=this.incomedata.map((function(e){var a=t.cm_data.find((function(t){return t.country===e.country}));return void 0===a||isNaN(e[t.state.year])||isNaN(a[t.state.year])?null:{country:e.country,income:e[t.state.year],child_mortality:a[[t.state.year]]}})).filter((function(t){return t.child_mortality>0})),a=1e3,n=1.5;null===this.timerID&&(2021==this.state.year&&(a=150),n=3);var r=p.h().domain([200,179e3]).range([0,700]),i=p.g().domain([0,a]).range([700,0]);p.i("#scatter").html(""),p.i("#ttip").html("");var c=p.i("#ttip").append("div").attr("class","tooltip").style("opacity",0);p.i("#scatter").append("g").attr("transform","translate(50,50)").selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t,e){return r(t.income)})).attr("cy",(function(t,e){return i(t.child_mortality)})).attr("r",(function(t,e){return n})).attr("fill","lightblue").on("mouseover",(function(t,e){c.transition().duration(200).style("opacity",1),c.html(e.country+"<br/>"+e.income+"<br/>"+e.child_mortality).style("left",t.pageX+"px").style("top",t.pageY-28+"px")})).on("mouseout",(function(t){c.transition().duration(500).style("opacity",0)})),p.i("#scatter").append("g").attr("transform","translate(50,50)").call(p.b(i).tickFormat(p.d("~s"))),p.i("svg").append("g").attr("transform","translate(50,750)").call(p.a(r).tickValues([300,1e3,3e3,1e4,3e4,1e5]).tickFormat(p.d("~s")))}},{key:"componentDidMount",value:function(){var t=Object(y.a)(m.a.mark((function t(){var e=this;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("/income-cm-narrative"),t.next=3,p.c("/income-cm-narrative/income_processed.csv");case 3:return this.incomedata=t.sent,t.next=6,p.c("/income-cm-narrative/child_mortality_0_5_year_olds_dying_per_1000_born.csv");case 6:this.cm_data=t.sent,this.updatechart(),this.timerID=setInterval((function(){return e.tick()}),25);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("Unmounting"),clearInterval(this.timerID),this.timerID=null,p.i("#scatter").html(""),p.i("#ttip").html("")}},{key:"componentDidUpdate",value:function(){this.updatechart()}},{key:"tick",value:function(){if(this.state.year>=2040)return clearInterval(this.timerID),this.timerID=null,void this.setState((function(t,e){return{year:2021}}));this.setState((function(t,e){return{year:t.year+1}}))}},{key:"setyear",value:function(t){clearInterval(this.timerID),this.timerID=null,this.setState({year:t.target.value})}},{key:"render",value:function(){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("form",{children:[Object(f.jsx)("label",{for:"year",children:"Please select a year: "}),Object(f.jsx)("input",{type:"range",min:1800,max:2040,step:1,id:"year",value:this.state.year,onInput:this.setyear}),Object(f.jsx)("output",{name:"selected_year",id:"selected_year",children:this.state.year})]}),Object(f.jsx)("div",{id:"ttip"}),Object(f.jsx)("svg",{id:"scatter",width:800,height:800,ref:this.svgRef})]})}}]),a}(n.Component),b=a(37),g=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(s.a)(this,a),(n=e.call(this,t)).svgRef=r.a.createRef(),n.state={year:1800},n.setyear=n.setyear.bind(Object(l.a)(n)),n.tick=n.tick.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"updatechart",value:function(){var t=this,e=500;2021==this.state.year&&null===this.timerID&&(e=100);for(var a=this.incomedata.map((function(e){var a=t.cm_data.find((function(t){return t.country===e.country}));return void 0===a||isNaN(e[t.state.year])||isNaN(a[t.state.year])?null:{country:e.country,income:e[t.state.year],child_mortality:a[[t.state.year]]}})).filter((function(t){return t.child_mortality>0})),n=a.sort((function(t,e){return parseFloat(t.income)-parseFloat(e.income)})).length,r=Math.floor(n/10),i={},c=0;c<10;c++)i[c]=[];for(var s=0;s<n;s++){var o=Math.floor(s/r);i[o=Math.min(o,9)].push(a[s])}for(var l=[],u=function(t,e){return t+parseFloat(e)},d=0;d<10;d++){var h=i[d],m=h.length,y=h.map((function(t){return t.child_mortality})).reduce(u,0),f=h.map((function(t){return t.income})).reduce(u,0);l.push({cm_avg:y/m,income_avg:f/m})}var v=p.f().domain(Object(b.a)(Array(10).keys())).range([0,700]).paddingInner(.2).paddingOuter(.2),j=p.g().domain([0,e]).range([700,0]);p.h().domain([200,179e3]).range([300,0]);p.i("#scatter").html(""),p.i("#ttip").html("");var g=p.i("#ttip").append("div").attr("class","tooltip").style("opacity",0);p.i("#scatter").append("g").attr("transform","translate(50,50)").selectAll("rect").data(l).enter().append("rect").attr("x",(function(t,e){return v(e)})).attr("y",(function(t,e){return j(t.cm_avg)})).attr("width",(function(t,e){return v.bandwidth()})).attr("height",(function(t,e){return 700-j(t.cm_avg)})).attr("fill",(function(t,e){return t.year>2021?"red":"lightblue"})).on("mouseover",(function(t,e){g.transition().duration(200).style("opacity",1),g.html("Average Income: "+e.income_avg+"<br/>"+e.cm_avg).style("left",t.pageX+"px").style("top",t.pageY-28+"px")})).on("mouseout",(function(t){g.transition().duration(500).style("opacity",0)})),p.i("#scatter").append("g").attr("transform","translate(50,50)").call(p.b(j).tickFormat(p.d("~s"))),p.i("svg").append("g").attr("transform","translate(50,750)").call(p.a(v))}},{key:"componentDidMount",value:function(){var t=Object(y.a)(m.a.mark((function t(){var e=this;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("chart mounted"),t.next=3,p.c("/income-cm-narrative/income_processed.csv");case 3:return this.incomedata=t.sent,t.next=6,p.c("/income-cm-narrative/child_mortality_0_5_year_olds_dying_per_1000_born.csv");case 6:this.cm_data=t.sent,this.updatechart(),this.timerID=setInterval((function(){return e.tick()}),25);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){console.log("Unmounting"),clearInterval(this.timerID),this.timerID=null,p.i("#scatter").html(""),p.i("#ttip").html("")}},{key:"componentDidUpdate",value:function(){this.updatechart()}},{key:"tick",value:function(){if(this.state.year>=2040)return clearInterval(this.timerID),this.timerID=null,void this.setState((function(t,e){return{year:2021}}));this.setState((function(t,e){return{year:t.year+1}}))}},{key:"setyear",value:function(t){clearInterval(this.timerID),this.timerID=null,this.setState({year:t.target.value})}},{key:"render",value:function(){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("form",{children:[Object(f.jsx)("label",{for:"year",children:"Please select a year: "}),Object(f.jsx)("input",{type:"range",min:1800,max:2040,step:1,id:"year",value:this.state.year,onInput:this.setyear}),Object(f.jsx)("output",{name:"selected_year",id:"selected_year",children:this.state.year})]}),Object(f.jsx)("div",{id:"ttip"}),Object(f.jsx)("svg",{id:"scatter",width:800,height:800,ref:this.svgRef})]})}}]),a}(n.Component),_=function(t){Object(u.a)(a,t);var e=Object(d.a)(a);function a(t){var n;return Object(s.a)(this,a),(n=e.call(this,t)).svgRef=r.a.createRef(),n.state={scene:0},n.setscene=n.setscene.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"setscene",value:function(){this.setState({scene:(this.state.scene+1)%3})}},{key:"render",value:function(){return 0==this.state.scene?Object(f.jsxs)("div",{children:[Object(f.jsx)("button",{onClick:this.setscene,children:"Change"}),Object(f.jsx)(j,{})]}):1==this.state.scene?Object(f.jsxs)("div",{children:[Object(f.jsx)("button",{onClick:this.setscene,children:"Change"}),Object(f.jsx)(v,{})]}):Object(f.jsxs)("div",{children:[Object(f.jsx)("button",{onClick:this.setscene,children:"Change"}),Object(f.jsx)(g,{})]})}}]),a}(n.Component);var O=function(){return Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(_,{})})},x=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,112)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,i=e.getLCP,c=e.getTTFB;a(t),n(t),r(t),i(t),c(t)}))};c.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(O,{})}),document.getElementById("root")),x()}},[[111,1,2]]]);
//# sourceMappingURL=main.93345305.chunk.js.map